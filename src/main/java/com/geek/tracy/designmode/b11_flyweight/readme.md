#二、结构型设计模式:

###11）享元模式(Flyweight Pattern)

> 享元模式是通过共享对象来减少系统对象的数量，其本质就是缓存共享对象，降低内存消耗。   
> 享元模式将需要重复使用的对象分为两个部分：内部状态和外部状态，内部状态是不会变化的，可以被多个对象共享，而外部状态会随着对象
> 的使用而改变。
> 


> 角色组成：   
> 抽象享元角色（Flyweight）：享元对象抽象基类或者接口，同时定义出对象的外部状态和内部状态的接口或实现；   
> 具体享元角色（ConcreteFlyweight）：实现抽象享元类中的方法，是需要共享的对象类；   
> 享元工程（FlyweightFactory）：维护一个享元对象的池，内部使用一个Map存储已经创建的享元对象；   

优缺点：   
> **优点：**   
> 1.共享大量相似对象，可以避免大量无畏的内存分配和释放操作，缓解垃圾回收器的压力，提高吞吐量；   
> 2.享元模式的内部对象和外部对象时分离的，内部状态存储在内存中，外部状态可以根据需要进行传递，这样可以有效地降低对象间的耦合度；   
> 3.共享的对象能够在多个线程中安全地共享并发访问，不会有线程安全问题；   
> **缺点：**   
> 1.实现比较复杂。实际开发中需要对内部对象和外部对象进行较为繁琐的区分；
> 2.增加代码的复杂度。

#### Java场景：   
+ String类型：内部维护了一个字符串对象池（即字符串常量池），相同的字符串只会在池中创建一次，之后它们会被多个对象共享，这样可以减少字符串对象的数量，
降低内存的使用，并提升系统的效率；
+ Integer类型：对常用的整数值（-128 - 127）进行了缓存，避免了每次创建新的Integer对象，提高了系统的性能；
+ 数据库连接池：数据库连接是非常消耗资源的，通过享元模式将连接池内部的连接对象进行复用，减少连接对象的创建和销毁，提高系统的效率和性能；
+ 线程池：通过享元模式将线程池中创建的线程对象进行复用，减少了线程的创建和销毁，从而提高系统的性能；


##### 举例
1）俄罗斯方块，抽象方块的享元类：AbstractBox，实际享元类为跟中形状的块，如：I型、L型、Z型等
2）定义方块享元类的工厂类：BoxFactory


